{"is_source_file": true, "format": "Python", "description": "This is a Python source file that implements JWT-based security utilities for an API, including functions for token validation, JWKS handling, role extraction from claims, and configuration resolution based on application settings.", "external_files": ["app.core.config", "app.core.security.roles", "app.schemas.security", "httpx", "jwt", "fastapi"], "external_methods": ["jwt.PyJWKClient", "jwt.decode", "jwt.ExpiredSignatureError", "jwt.InvalidTokenError", "httpx.Client", "httpx.Client.get"], "published": ["clear_jwks_cache", "verify_access_token", "fetch_oidc_jwks_uri_from_issuer", "unix_time"], "classes": [{"name": "JWKSConfig", "description": "Dataclass storing JWKS configuration details including issuer, audience, URI, and algorithms."}], "methods": [{"name": "_coerce_list", "description": "Converts various input types into a list of strings for algorithms or other list-like claims."}, {"name": "_resolve_jwks_config", "description": "Resolves and validates the JWKS configuration from application settings."}, {"name": "_extract_bearer_token", "description": "Extracts the bearer token from an authorization header string."}, {"name": "_roles_from_claims", "description": "Parses roles from JWT claims in various formats."}, {"name": "_principal_from_claims", "description": "Creates a Principal object from JWT claims, extracting subject, email, and roles."}, {"name": "clear_jwks_cache", "description": "Clears the in-memory cache of JWKS clients."}, {"name": "verify_access_token", "description": "Verifies a JWT access token using JWKS and returns the associated Principal object."}, {"name": "fetch_oidc_jwks_uri_from_issuer", "description": "Retrieves the JWKS URI from the OIDC discovery endpoint from a given issuer URL."}, {"name": "unix_time", "description": "Returns the current Unix timestamp."}], "calls": ["jwt.decode", "PyJWKClient.get_signing_key_from_jwt", "httpx.Client.get", "resp.json()"], "search-terms": ["JWT", "JWKS", "OIDC", "access token verification", "security roles", "OAuth2 bearer token", "JWKS cache", "Principal", "FastAPI HTTPException"], "state": 2, "file_id": 44, "knowledge_revision": 141, "git_revision": "749667ff558d78ec1efbd0cd6de8e8a3140a3aa3", "ctags": [], "hash": "acbc5f6e61b07f38e0090f8fefb8e888", "format-version": 4, "code-base-name": "CoreAPI&Services", "filename": "CoreAPI&Services/app/core/security/jwt.py", "revision_history": [{"141": "749667ff558d78ec1efbd0cd6de8e8a3140a3aa3"}]}