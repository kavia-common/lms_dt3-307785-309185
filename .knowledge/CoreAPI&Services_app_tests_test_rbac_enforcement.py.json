{"is_source_file": true, "format": "Python", "description": "This file contains unit tests for RBAC enforcement in a FastAPI application, testing user listing and deletion permissions.", "external_files": ["app/api/routers/users", "app.core.config", "app.main", "fastapi.testclient"], "external_methods": ["get_users_service", "clear_settings_cache", "create_app"], "published": [], "classes": [{"name": "_FakeUsersService", "description": "A mock service class used within tests to simulate user service behaviors."}], "methods": [{"name": "test_users_list_requires_auth", "description": "Tests that the user list endpoint requires authentication and returns 401 if not authenticated."}, {"name": "test_users_list_forbidden_without_read_role", "description": "Tests that access without proper roles results in a 403 Forbidden response."}, {"name": "test_users_list_allowed_with_learner_role", "description": "Tests that a user with the 'Learner' role can successfully retrieve the user list."}, {"name": "test_users_delete_requires_admin", "description": "Tests that only users with the 'Admin' role can delete users, enforcing RBAC policies."}], "calls": ["monkeypatch.setenv", "clear_settings_cache", "create_app", "TestClient(app).get", "TestClient(app).delete", "_FakeUsersService.list_users", "_FakeUsersService.delete_user"], "search-terms": ["test_rbac_enforcement", "FastAPI RBAC", "dependency_overrides", "TestClient", "mock service", "user deletion RBAC", "role-based access control tests"], "state": 2, "file_id": 47, "knowledge_revision": 150, "git_revision": "749667ff558d78ec1efbd0cd6de8e8a3140a3aa3", "ctags": [], "hash": "65a02ad6ac9dfe906fe524c48d9974bc", "format-version": 4, "code-base-name": "CoreAPI&Services", "filename": "CoreAPI&Services/app/tests/test_rbac_enforcement.py", "revision_history": [{"150": "749667ff558d78ec1efbd0cd6de8e8a3140a3aa3"}]}